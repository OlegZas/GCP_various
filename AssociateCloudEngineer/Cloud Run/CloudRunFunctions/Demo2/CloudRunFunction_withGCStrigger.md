# Cloud Run Functions with GCS trigger 
### Creating a cloud function with gcs trigger (move file to different bucket)


---
> [!NOTE]
> Description: File is uploaded to the storage bucket. This triggers a cloud function. The function checks the file size and if it’s > 2mb then moves it to another bucket, but if < 2 then will keep the file in this bucket. 

 ![image](https://github.com/user-attachments/assets/5df40816-3b94-484e-a91a-7d5d778817bf)

## 1. In Cloud Run click on “Write a function” 
## 2. Create Cloud Storage bucket. 
## 3. Start creating a function with the GCS trigger chosen from options. 
 ![image](https://github.com/user-attachments/assets/a200c440-8d37-442f-89a0-c9d8abe665f6)

## 4. Customize your function script: 
 ![image](https://github.com/user-attachments/assets/23fe35f4-d3f0-45bd-b6b1-8c6719ef0fef)

## 5. After uploading the data to the Cloud Storage, check the Logs of the function to see the data generated by the function. 
![image](https://github.com/user-attachments/assets/280160be-a685-4c0d-bb29-44f3c43901f8)

## 6. Create a 2nd bucket 
## 7. Create your python script: 
- in this case I will move the file to another bucket if constraints are met
  
 ![image](https://github.com/user-attachments/assets/fd5dd756-c400-43f1-b2de-5b94790e90fc)


> [!TIP]
> NOTE: Cloud Run is designed to handle only HTTP requests, so your function must accept a request object, which represents the incoming HTTP request. In contrast, Cloud Functions can handle both HTTP and background events (like GCS triggers) and use event and context parameters for those. If you try to use event, context in Cloud Run, it will fail because Cloud Run never passes those — it only sends a structured HTTP request.
> -	Must use: def ozmovingfiles(request: Request):
> -	Not: def ozmovingfiles(event, context):

## 8. Upload file – it should be moved immediately by your function: 
 
![image](https://github.com/user-attachments/assets/cd3003e1-8a9d-4103-adf6-c4f28bab14d0)

 ![image](https://github.com/user-attachments/assets/d8bde357-230c-4752-8218-6f0763b539ee)

	
